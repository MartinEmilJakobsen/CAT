# Structure Learning for Directed Trees
Repository for simulations and illustrations for "Structure Learning for Directed Trees" @ https://arxiv.org/abs/2108.08871. 


## Implementation of CAT
An implementation of CA procedure is found in the Rscript "CAT.R".

### Requirements

### Usage

> `CAT(data, opt.args)`

#### Arguments
* data: a data.frame object with row-wise observations and columns representing system variables.
* noise: 
* workers:
* numbasisfnct
* pvalCutoff
* crossfit


The CAT estimate is computed by running:

CAT(data,noise,workers,numbasisfnct = NULL)

where data is the datamatrix (rowwise observations, columnwise nodes), noise ="G" uses the Gaussian score and noise ="NA" uses the entropy score, workers sets the number of threads to run the CAT method on, and numbasisfnct sets the number of basisfunctions for the GAM spline estimation of the conditional means.

## Implementation of hypothesis testing procedure


## How to replicate experiments in paper

This repository also contains all R scripts for conducting the experiments referenced in the paper. In /Data the experiment data used in the paper is present. Thus, to simply rerun analysis and illustration generation on this data start from step 2) below and ignore comments about data-pointers.

If you want to replicate all experiments then start from step 1) and do not ignore comments about data-pointer as the subsequent analysis and illustration generation has to point to the newly generated data.

### 1) Data generation 


To generate the experiment data: Run Script.R or manually run the following scripts. 

1. **CAMvsTree_GP_Gaussian.R**
    * *This script runs the Gaussian Process Gaussian Noise Experiment*
2. **CAMvsTree_GP_Gaussian_CamScores.R**
    * *This script runs the Gaussian Process Gaussian Noise Experiment but CAT uses the CAM scores*
3. **CAMvsTree_GP_NonGaussian.R**
    * *This script runs the Gaussian Process Non-Gaussian Noise Experiment*
4. **IdentifiabilityConstantBi.R**
    * *This scripts runs the bivariate identifiability gap experiment*
5. **IdentifiabilityConstantMulti.R**
    * *This scripts runs the multivariate identifiability gap experiment*

###

### 2) Data Analysis and Generate Illustrations

All analysis and illustrations on experiment data reported in the paper is generated by the following script

1. **AnalysisOfData.R**

Illustrations of the Gaussian process samplepaths are generated by the script

1. **SamplePathIllustrations.R**

Note that data-pointers in these scripts have to be adjusted to if used on new experiment data.


## Version control
The folder CAM_1.0 contains the R-package CAM used.
